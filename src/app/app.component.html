
<!-- 1) LANDING PAGE SI NON CONNECT√â -->

 <!-- LANDING MOBILE -->

<div *ngIf="!authService.isLoggedIn()"
  class="xl:hidden min-h-screen w-full bg-linear-to-b from-white via-[#fdfffe] to-[#eaf1ef]">

  <div class="flex flex-col items-center px-4 pt-12 text-center">

    <img src="assets/logo.png" class="w-85 mb-2">

    <h1 class="text-3xl font-extrabold text-gray-800">
      G√©rez vos t√¢ches.<br>
      √âchangez autour.
    </h1>

    <p class="text-gray-500 text-base mt-4 max-w-xs">
      Une vision claire de vos t√¢ches et de vos collaborations.
    </p>

    <div class="mt-12 bg-white rounded-2xl shadow-lg p-3">
      <img src="assets/feature1.png" class="w-70">
    </div>
  </div>

  <!-- FEATURES -->
  <div class="mt-14 px-4 space-y-6 max-w-sm mx-auto">
    <div class="bg-white rounded-xl p-4 shadow-sm">
      <p class="font-semibold text-sm">üìã Organisation claire</p>
      <p class="text-ss text-gray-500 mt-1">
        Visualisez toutes vos t√¢ches et projets.
      </p>
    </div>

    <div class="bg-white rounded-xl p-4 shadow-sm">
      <p class="font-semibold text-sm">üë• Collaboration</p>
      <p class="text-ss text-gray-500 mt-1">
        Centralisez vos contacts.
      </p>
    </div>

    <div class="bg-white rounded-xl p-4 shadow-sm">
      <p class="font-semibold text-sm">üí¨ Discussions</p>
      <p class="text-ss text-gray-500 mt-1">
        Discutez autour des t√¢ches.
      </p>
    </div>

    <div class="bg-white rounded-xl p-4 shadow-sm">
      <p class="font-semibold text-sm">‚úâÔ∏è Envois d'emails</p>
      <p class="text-ss text-gray-500 mt-1">
        Informez les contacts concern√©s.
      </p>
    </div>
  </div>


  <!-- SWITCH -->
  <div class="mt-16 flex justify-center">
    <div class="flex flex-col p-1 gap-1">

      <button (click)="openSignup()" class="px-4 py-2 border-0 rounded-full text-sm transition bg-emerald-300 text-white">
        Commencer
      </button>

      <p class="text-xs text-gray-500">
        D√©j√† un compte ?
        <span
          (click)="openLogin()"
          class="text-emerald-500 hover:text-black cursor-pointer">
          Je me connecte
        </span>
      </p>
    </div>
  </div>

<!-- ================= AUTH MODALE ================= -->
<div *ngIf="mobileAuth"
     class="fixed inset-0 z-50 bg-black/40
            flex items-start justify-center
            overflow-y-auto px-4 py-8">

  <div
    class="bg-white rounded-2xl shadow-xl
           w-full max-w-sm
           relative
           max-h-[90vh] flex flex-col">

    <!-- Close -->
    <button
      (click)="closeAuth()"
      class="absolute top-3 right-3 z-10
             text-gray-400 hover:text-black">
      ‚úï
    </button>

    <!-- Content -->
    <div class="p-6 overflow-y-auto">
      <app-login *ngIf="mobileAuth === 'login'"></app-login>
      <app-signup *ngIf="mobileAuth === 'signup'"></app-signup>
    </div>

  </div>
</div>



</div>



<!-- LANDING DESKTOP -->
<div *ngIf="!authService.isLoggedIn()" class="hidden lg:flex min-h-screen w-full flex-row overflow-x-hidden
            bg-linear-to-r from-white via-[#fdfffe] to-[#eaf1ef]">

  <!-- COLONNE GAUCHE -->
  <div class="w-1/2 flex flex-col justify-start items-center p-4 mx-auto">

    <div class="w-[180px] h-[90px] overflow-hidden">
      <img src="assets/logo.png" alt="WeDone" class="w-full h-full object-cover scale-170">
    </div>

    <h1 class="text-3xl font-extrabold text-gray-800 text-center leading-snug mt-20 mb-6 px-2">
      G√©rez vos t√¢ches.<br>
      √âchangez autour.
    </h1>

    <p class="text-gray-600 text-base text-center max-w-sm mb-14 px-2">
      Une vision claire de vos t√¢ches et de vos collaborations.
    </p>

    <!-- FEATURES SCROLL -->
    <div class="w-full overflow-x-auto">
      <div class="flex gap-16 py-6 px-4 min-w-max">

        <div class="flex flex-col items-center text-center">
          <div class="feature-card">
            <img src="assets/feature1.png" class="feature-img">
          </div>
          <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
            <span class="text-3xl">1<br></span>
            Visualisez toutes vos t√¢ches et projets.
          </p>
        </div>

        <div class="flex flex-col items-center text-center">
          <div class="feature-card">
            <img src="assets/feature2.png" class="feature-img">
          </div>
          <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
            <span class="text-3xl">2<br></span>
            Centralisez vos contacts.
          </p>
        </div>

        <div class="flex flex-col items-center text-center">
          <div class="feature-card">
            <img src="assets/feature3.png" class="feature-img">
          </div>
          <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
            <span class="text-3xl">3<br></span>
            Discutez autour des t√¢ches.
          </p>
        </div>

        <div class="flex flex-col items-center text-center">
          <div class="feature-card">
            <img src="assets/feature4.png" class="feature-img">
          </div>
          <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
            <span class="text-3xl">4<br></span>
            Informez les contacts concern√©s.
          </p>
        </div>

      </div>
    </div>
  </div>

  <!-- COLONNE DROITE : AUTH -->
  <div class="w-1/2 flex justify-center items-center overflow-hidden">
    <div class="w-full max-w-sm mx-auto">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>



<!-- 2) LAYOUT STANDARD SI CONNECT√â -->

<mat-sidenav-container *ngIf="authService.isLoggedIn()" class="h-screen">

  <!-- SIDENAV -->
  <mat-sidenav #sidenav [mode]="isMobile ? 'over' : 'side'" [opened]="!isMobile" class="custom-sidenav !rounded-none">

    <!-- Recherche t√¢che -->
    <div class="flex items-center bg-white rounded-full w-4/5 ml-3 mt-6 mb-6 pr-4">
      <button mat-icon-button (click)="onSearchTodo()" class="flex items-center justify-center w-8 h-8">
        <mat-icon class="mt-1">search</mat-icon>
      </button>

      <input matInput [(ngModel)]="rechercheTodo" (input)="filtrerTodos()" [matAutocomplete]="auto"
        placeholder="Go vers une t√¢che" class="border-none outline-none bg-transparent text-sm flex-1" />

      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="goToTodo($event.option.value)">
        <mat-option *ngFor="let todo of suggestions" [value]="todo.title" class="!text-xs">
          {{ todo.title }}
        </mat-option>
      </mat-autocomplete>
    </div>


    <!-- MENU SIDENAV -->
    <mat-nav-list>

      <!-- Menu connect√© -->
      @if (authService.isLoggedIn()) {
      @for (section of sections; track section.title; let isLast = $last) {

      @if ((section.adminOnly && authService.isAdmin()) || (!section.adminOnly)) {

      @if (section.title !== '') {
      <h4
        class="flex items-center gap-2 ml-4 mt-6 mb-2 text-[11px] font-semibold tracking-wider uppercase text-gray-800">
        @if (section.icon) {
        <mat-icon class="text-gray-800 text-base align-middle">{{ section.icon }}</mat-icon>
        }
        {{ section.title }}
      </h4>
      }

      @for (item of section.items; track item.path) {
      <a mat-list-item [routerLink]="item.path"
        class="!text-gray-500 text-ss hover:!#f1f3f5 rounded-md !h-9 flex items-center px-3 transition-all"
        [ngClass]="router.url === item.path ? 'active-link' : ''">
        @if (item.icon) {
        <mat-icon class="text-base mr-0.5 align-middle">{{ item.icon }}</mat-icon>
        }
        {{ item.label }}
      </a>
      }

      @if (!isLast) {
      <div class="h-[1px] bg-gray-300/40 mx-3 my-3"></div>
      }

      }
      }
      }

    </mat-nav-list>

  </mat-sidenav>



  <!-- CONTENU PRINCIPAL -->
  <mat-sidenav-content class="flex flex-col h-full">

    <!-- Toolbar -->
    <mat-toolbar color="primary" class="sticky top-0 z-50 flex justify-between">
      <span><img src="assets/logo_petit.png" alt="WeDone" class="w-30 max-w-full"></span>

      <button *ngIf="isMobile" mat-icon-button (click)="topMenuOpen = !topMenuOpen">
        <mat-icon>menu</mat-icon>
      </button>
    </mat-toolbar>


    <!-- MENU MOBILE -->
    <div *ngIf="isMobile && topMenuOpen" class="absolute w-full z-50 shadow-md p-1.5 custum-nav-mob">

      <mat-nav-list id="menumob" class="space-y-0.5">

        @if (authService.isLoggedIn()) {
        @for (section of sections; track section.title) {

        @if ((section.adminOnly && authService.isAdmin()) || (!section.adminOnly)) {

        @if (section.title !== '') {
        <h4 class="ml-1 mt-2 mb-2 text-[11px] font-semibold tracking-wider uppercase text-gray-800">
          {{ section.title }}
        </h4>
        }

        @for (item of section.items; track item.path) {
        <a mat-list-item [routerLink]="item.path" (click)="topMenuOpen = false"
          class="block !text-gray-700 text-[9px] leading-tight !p-2 !h-auto hover:!#f1f3f5 rounded-sm transition">
          @if (item.icon) {
          <mat-icon class="text-base mr-0.5 align-middle">{{ item.icon }}</mat-icon>
          }
          {{ item.label }}
        </a>
        }

        <div class="h-[1px] bg-gray-300/30 mx-1 my-1"></div>

        }
        }
        }

      </mat-nav-list>

    </div>


    <!-- ROUTER -->
    <div class="flex-1 overflow-auto p-4 sm:p-0">
      <router-outlet></router-outlet>
    </div>

  </mat-sidenav-content>

</mat-sidenav-container>