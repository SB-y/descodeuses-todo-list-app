<!-- 1) LANDING PAGE SI NON CONNECTÉ -->
<div *ngIf="!authService.isLoggedIn()"
  class="landing-container min-h-screen w-full flex flex-col lg:flex-row overflow-x-hidden bg-linear-to-r! from-white via-[#fdfffe] to-[#eaf1ef]">

  <!-- COLONNE GAUCHE bg-gradient-to-b from-[#eaf1ef] via-[#F4F9F8] to-white-->
  <div class="w-full lg:w-1/2 
  flex flex-col justify-start items-center lg:p-4 mx-auto max-w-full">


    <!-- Logo -->
    <div class="w-[180px] h-[90px] overflow-hidden">
      <img src="assets/logo.png" alt="WeDone"
           class="w-full h-full object-cover scale-170">
    </div>

    <!-- Titre -->
    <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 text-center leading-snug mt-20 mb-6 sm:mb-8 px-2">
      Gérez vos tâches, vos projets, et collaborez facilement.
    </h1>

    <!-- Sous-titre -->
    <p class="text-gray-600 text-sm sm:text-base text-center max-w-xs sm:max-w-sm mb-14 px-2">
      Une plateforme simple, flexible, et collaborative pour organiser votre quotidien.
    </p>

    <!-- FONCTIONNALITÉS -->
    <div class="flex flex-col lg:flex-row items-center justify-center
                gap-6 sm:gap-10 lg:gap-12 w-full max-w-full">

      <!-- VERSION MOBILE & TABLETTE = affichage en colonne -->
<div class="flex flex-col items-center gap-10 py-6 px-4 lg:hidden">

  <div class="flex flex-col items-center text-center">
    <div class="feature-card-mob">
      <img src="assets/feature1.png" class="feature-img">
    </div>
    <p class="text-sm text-gray-700 mt-4 max-w-[14rem]">
    Visualisez clairement toutes vos tâches et tous vos projets.
    </p>
  </div>

  <div class="flex flex-col items-center text-center">
    <div class="feature-card-mob">
      <img src="assets/feature2.png" class="feature-img">
    </div>
    <p class="text-sm text-gray-700 mt-4 max-w-[14rem]">
    Créez votre répertoire de contacts.
    </p>
  </div>

  <div class="flex flex-col items-center text-center">
    <div class="feature-card-mob">
      <img src="assets/feature3.png" class="feature-img">
    </div>
    <p class="text-sm text-gray-700 mt-4 max-w-[14rem]">
    Discutez avec vos collaborateurs de l'app.
    </p>
  </div>

  <div class="flex flex-col items-center text-center">
    <div class="feature-card-mob">
      <img src="assets/feature4.png" class="feature-img">
    </div>
    <p class="text-sm text-gray-700 mt-4 max-w-[14rem]">
    Envoyez un mail à vos contacts assignés à une tâche.
    </p>
  </div>
</div>


      <!-- SCROLL HORIZONTAL DESKTOP -->
      <div class="hidden lg:block w-full overflow-x-auto">
        <div class="flex gap-16 py-6 px-4 min-w-max">

          <div class="flex flex-col items-center text-center">
            <div class="feature-card">
              <img src="assets/feature1.png" class="feature-img">
            </div>
            <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
              <span class="text-3xl">1<br></span>Visualisez clairement toutes vos tâches et tous vos projets.
            </p>
          </div>

          <div class="flex flex-col items-center text-center">
            <div class="feature-card">
              <img src="assets/feature2.png" class="feature-img">
            </div>
            <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
              <span class="text-3xl">2<br></span>Créez votre répertoire de contacts.
            </p>
          </div>

          <div class="flex flex-col items-center text-center">
            <div class="feature-card">
              <img src="assets/feature3.png" class="feature-img">
            </div>
            <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
              <span class="text-3xl">3<br></span>Discutez avec les utilisateurs de l'app associés à une tâche.
            </p>
          </div>

          <div class="flex flex-col items-center text-center">
            <div class="feature-card">
              <img src="assets/feature4.png" class="feature-img">
            </div>
            <p class="text-ss text-gray-700 mt-4 max-w-[14rem]">
              <span class="text-3xl">4<br></span> Envoyez un mail à vos contacts associés à une tâche.
            </p>
          </div>

        </div>
      </div>
    </div>
  </div>

  


  <!-- COLONNE DROITE -->
  <div class="w-full lg:w-1/2 flex justify-center items-center max-w-full min-w-0 overflow-hidden ">

    <!-- Empêche router-outlet de dépasser -->
    <div class="w-full max-w-sm mx-auto">
      <router-outlet></router-outlet>
    </div>

  </div>

</div>


<!-- 2) LAYOUT STANDARD SI CONNECTÉ -->
<mat-sidenav-container *ngIf="authService.isLoggedIn()" class="h-screen">

  <!-- SIDENAV -->
  <mat-sidenav #sidenav [mode]="isMobile ? 'over' : 'side'" [opened]="!isMobile"
    class="custom-sidenav !rounded-none">

    <!-- Recherche tâche -->
    <div class="flex items-center bg-white rounded-full w-4/5 ml-3 mt-6 mb-6 pr-4">
      <button mat-icon-button (click)="onSearchTodo()" class="flex items-center justify-center w-8 h-8">
        <mat-icon class="mt-1">search</mat-icon>
      </button>

      <input matInput [(ngModel)]="rechercheTodo" (input)="filtrerTodos()" [matAutocomplete]="auto"
        placeholder="Go vers une tâche" class="border-none outline-none bg-transparent text-sm flex-1" />

      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="goToTodo($event.option.value)">
        <mat-option *ngFor="let todo of suggestions" [value]="todo.title" class="!text-xs">
          {{ todo.title }}
        </mat-option>
      </mat-autocomplete>
    </div>


    <!-- MENU SIDENAV -->
    <mat-nav-list>

      <!-- Menu connecté -->
      @if (authService.isLoggedIn()) {
      @for (section of sections; track section.title; let isLast = $last) {

      @if ((section.adminOnly && authService.isAdmin()) || (!section.adminOnly)) {

      @if (section.title !== '') {
      <h4
        class="flex items-center gap-2 ml-4 mt-6 mb-2 text-[11px] font-semibold tracking-wider uppercase text-gray-800">
        @if (section.icon) {
        <mat-icon class="text-gray-800 text-base align-middle">{{ section.icon }}</mat-icon>
        }
        {{ section.title }}
      </h4>
      }

      @for (item of section.items; track item.path) {
      <a mat-list-item [routerLink]="item.path"
        class="!text-gray-500 text-ss hover:!#f1f3f5 rounded-md !h-9 flex items-center px-3 transition-all"
        [ngClass]="router.url === item.path ? 'active-link' : ''">
        @if (item.icon) {
        <mat-icon class="text-base mr-0.5 align-middle">{{ item.icon }}</mat-icon>
        }
        {{ item.label }}
      </a>
      }

      @if (!isLast) {
      <div class="h-[1px] bg-gray-300/40 mx-3 my-3"></div>
      }

      }
      }
      }

    </mat-nav-list>

  </mat-sidenav>



  <!-- CONTENU PRINCIPAL -->
  <mat-sidenav-content class="flex flex-col h-full">

    <!-- Toolbar -->
    <mat-toolbar color="primary" class="sticky top-0 z-50 flex justify-between">
      <span><img src="assets/logo_petit.png" alt="WeDone" class="w-30 max-w-full"></span>

      <button *ngIf="isMobile" mat-icon-button (click)="topMenuOpen = !topMenuOpen">
        <mat-icon>menu</mat-icon>
      </button>
    </mat-toolbar>


    <!-- MENU MOBILE -->
    <div *ngIf="isMobile && topMenuOpen" class="absolute w-full z-50 shadow-md p-1.5" [ngClass]="{
             'bg-admin': authService.isAdmin(),
             'bg-user': authService.isUser(),
             'bg-default': !authService.isAdmin() && !authService.isUser()
           }">

      <mat-nav-list id="menumob" class="space-y-0.5">

        @if (authService.isLoggedIn()) {
        @for (section of sections; track section.title) {

        @if ((section.adminOnly && authService.isAdmin()) || (!section.adminOnly)) {

        @if (section.title !== '') {
        <h4 class="ml-1 mt-2 mb-2 text-[11px] font-semibold tracking-wider uppercase text-gray-800">
          {{ section.title }}
        </h4>
        }

        @for (item of section.items; track item.path) {
        <a mat-list-item [routerLink]="item.path" (click)="topMenuOpen = false"
          class="block !text-gray-700 text-[9px] leading-tight !p-2 !h-auto hover:!#f1f3f5 rounded-sm transition">
          @if (item.icon) {
          <mat-icon class="text-base mr-0.5 align-middle">{{ item.icon }}</mat-icon>
          }
          {{ item.label }}
        </a>
        }

        <div class="h-[1px] bg-gray-300/30 mx-1 my-1"></div>

        }
        }
        }

      </mat-nav-list>

    </div>


    <!-- ROUTER -->
    <div class="flex-1 overflow-auto p-4 sm:p-0">
      <router-outlet></router-outlet>
    </div>

  </mat-sidenav-content>

</mat-sidenav-container>